<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template name="treeview" match="core">
<xsl:param name="depth"/> 
<xsl:param name="content"/> 
<xsl:param name="radix"/>
<xsl:param name="radix_base"/>


<!-- <xsl:value-of select="number($depth)"/> -->
<xsl:for-each select="$content/core|$content/comment()|$content/variable|$content/cmake|$content/info">
<!-- <xsl:value-of select="@name"/> -->

<xsl:variable name="radixc"><xsl:value-of select="$radix"/><xsl:value-of select="@name"/></xsl:variable>


<xsl:if test="self::comment()"><xsl:copy-of select="."/></xsl:if>
<xsl:if test="self::node()">
<xsl:if test="local-name(.)='info'"><xsl:copy-of select="."/></xsl:if>
<xsl:if test="local-name(.)='cmake'"><xsl:copy-of select="."/></xsl:if>
<xsl:if test="local-name(.)='variable'"><xsl:copy-of select="."/></xsl:if><xsl:text>&#xA;</xsl:text>
</xsl:if>

<xsl:if test="local-name(.)='core'"> 
<xsl:comment> (<xsl:value-of select="$depth+1"/>) <xsl:value-of select="$radixc"/> this is a fragile-comment</xsl:comment>
<xsl:text>&#xA;</xsl:text>
<xsl:copy select="."> 
  <xsl:copy-of select="@*"/>
<xsl:variable name="radixa"><xsl:value-of select="$radix"/><xsl:value-of select="@name"/>_</xsl:variable>
<xsl:variable name="radixb"><xsl:value-of select="$radix"/><xsl:value-of select="@name"/></xsl:variable>
<xsl:call-template name="treeview">
<xsl:with-param name="content" select="."/>
<xsl:with-param name="depth" select="number($depth)+1"/> 
<xsl:with-param name="radix" select="$radixa"/>
<xsl:with-param name="radix_base" select="$radixb"/>
</xsl:call-template>
</xsl:copy>
<xsl:text>&#xA;</xsl:text>
</xsl:if>
</xsl:for-each>
</xsl:template>

<xsl:template match="/">
<xsl:comment>Autogenerated</xsl:comment>
<xsl:text disable-output-escaping="yes">&lt;ftmake&gt;</xsl:text> 

<xsl:call-template name="treeview">
<xsl:with-param name="content" select="/ftmake"/>
<xsl:with-param name="depth" select="0"/>
</xsl:call-template>
<xsl:text disable-output-escaping="yes">&lt;/ftmake&gt;</xsl:text> 

</xsl:template>
</xsl:stylesheet>
